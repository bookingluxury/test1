<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ƒêƒÉng Nh·∫≠p</title>
    <style>
      body {
        background: radial-gradient(
          circle at top,
          #ff9a9e,
          #ff758c,
          #ff7eb3,
          #fad0c4
        );
        background-size: 200% 200%;
        animation: gradientShift 10s ease infinite;
        color: white;
        font-family: "Poppins", sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        flex-direction: column;
      }
      @keyframes gradientShift {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      /* Hi·ªáu ·ª©ng nh·∫•p nh√°y */
      @keyframes sparkle {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.5;
          clip-path: circle(50%); /* Ban ƒë·∫ßu l√† h√¨nh tr√≤n */
        }
        50% {
          transform: scale(1.5);
          opacity: 1;
          clip-path: polygon(
            50% 0%,
            61% 35%,
            98% 35%,
            68% 57%,
            79% 91%,
            50% 70%,
            21% 91%,
            32% 57%,
            2% 35%,
            39% 35%
          );
          /* Chuy·ªÉn th√†nh ng√¥i sao 5 c√°nh khi l√≥e s√°ng */
        }
      }

      .star {
        position: absolute;
        width: 7px;
        height: 7px;
        background: white;
        border-radius: 50%;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        animation: sparkle infinite ease-in-out;
        opacity: 0.5;
        transition: top 3s ease, left 3s ease; /* Di chuy·ªÉn m∆∞·ª£t m√† */
      }
      /* Logo m·ªõi n·∫±m tr√™n c√πng */
      .logo-top {
        position: fixed;
        top: 5px;
        left: 50%;
        transform: translateX(-50%);
        width: 350px; /* TƒÉng k√≠ch th∆∞·ªõc ƒë·ªÉ r√µ h∆°n */
        height: 105px;
        background: url("https://i.ibb.co/DgYWjtjM/logo-490c306a.png") no-repeat
          center/contain;
        background-size: cover; /* ƒê·∫£m b·∫£o h√¨nh ·∫£nh v·ª´a v·ªõi khung */
        z-index: 1001;
        transition: transform 0.3s ease;
        padding: 5px;
        backdrop-filter: blur(5px); /* Hi·ªáu ·ª©ng m·ªù n·ªÅn */
      }

      /* Hi·ªáu ·ª©ng khi hover v√†o logo */
      .logo-top:hover {
        transform: translateX(-50%) scale(1.1); /* Ph√≥ng to nh·∫π khi hover */
      }

      .logo {
        width: 100px;
        height: 100px;
        border-radius: 10%;
        background: url("https://i.ibb.co/GQ75nVT5/Untitled-design-2025-02-06-T181058-158.png")
          no-repeat center/cover;
        margin-bottom: 20px;
      }

      .form-container {
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        width: 70%;
      }

      h2 {
        margin-bottom: 30px;
        color: #0a0a0a;
      }

      input[type="text"],
      input[type="password"],
      input[type="tel"] {
        width: 95%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 15px;
        font-size: 1rem;
      }

      button {
        width: 100%;
        padding: 10px;
        background-color: #000000;
        color: #fff;
        border: none;
        border-radius: 15px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
        transition: background-color 0.3s;
      }

      button:hover {
        background-color: #d81b60;
      }

      .form-links {
        margin-top: 10px;
        font-size: 14px;
      }

      .form-links a {
        color: #000000;
        margin: 0 5px;
      }

      .form-links a:hover {
        text-decoration: underline;
      }

      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="logo-top"></div>
    <div class="logo"></div>
    <div class="stars" style="top: 50px; left: 100px"></div>
    <div class="stars" style="top: 120px; left: 300px"></div>
    <div class="stars" style="top: 200px; left: 500px"></div>
    <div class="stars" style="top: 350px; left: 700px"></div>
    <div class="stars" style="top: 450px; left: 150px"></div>
    <div class="stars" style="top: 600px; left: 400px"></div>
    <div class="stars" style="top: 50px; left: 800px"></div>
    <div class="stars" style="top: 300px; left: 900px"></div>

    <!-- Form ƒëƒÉng nh·∫≠p -->
    <div id="login-form" class="form-container">
      <h2>ƒêƒÉng nh·∫≠p</h2>
      <input type="text" id="login-username" placeholder="T√™n ng∆∞·ªùi d√πng" />
      <input type="password" id="login-password" placeholder="M·∫≠t kh·∫©u" />
      <button id="login-btn">ƒêƒÉng nh·∫≠p</button>
      <!-- Th√™m ID cho n√∫t ƒëƒÉng nh·∫≠p -->
      <div class="form-links">
        <a href="#" id="show-forgot">Qu√™n m·∫≠t kh·∫©u?</a>
        <span>|</span>
        <a href="#" id="show-register">ƒêƒÉng k√Ω ngay</a>
      </div>
    </div>

    <!-- Form ƒëƒÉng k√Ω -->
    <div id="register-form" class="form-container hidden">
      <h2>ƒêƒÉng k√Ω</h2>
      <input type="text" id="reg-username" placeholder="T√™n ng∆∞·ªùi d√πng" />
      <input type="tel" id="reg-phone" placeholder="S·ªë ƒëi·ªán tho·∫°i" />
      <input type="password" id="reg-password" placeholder="M·∫≠t kh·∫©u" />
      <input type="password" id="reg-confirm" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u" />
      <button id="register-btn">ƒêƒÉng k√Ω</button>
      <!-- ID cho n√∫t ƒëƒÉng k√Ω -->
      <div class="form-links">
        <a href="#" id="show-login-from-register">ƒê√£ c√≥ t√†i kho·∫£n? ƒêƒÉng nh·∫≠p</a>
      </div>
    </div>

    <!-- Form qu√™n m·∫≠t kh·∫©u -->
    <div id="forgot-form" class="form-container hidden">
      <h2>Qu√™n m·∫≠t kh·∫©u</h2>
      <input type="text" id="forgot-username" placeholder="T√™n ng∆∞·ªùi d√πng" />
      <input type="tel" id="forgot-phone" placeholder="S·ªë ƒëi·ªán tho·∫°i" />
      <button id="forgot-btn">G·ª≠i y√™u c·∫ßu</button>
      <!-- ID cho n√∫t g·ª≠i y√™u c·∫ßu -->
      <div class="form-links">
        <a href="#" id="show-login-from-forgot">Tr·ªü l·∫°i ƒëƒÉng nh·∫≠p</a>
      </div>
    </div>

    <!-- JavaScript chuy·ªÉn ƒë·ªïi gi·ªØa c√°c form -->
    <script>
      const numStars = 8; // S·ªë l∆∞·ª£ng sao
      const body = document.body;

      const stars = [];

      // T·∫°o c√°c ng√¥i sao v·ªõi v·ªã tr√≠ ban ƒë·∫ßu ng·∫´u nhi√™n
      for (let i = 0; i < numStars; i++) {
        const star = document.createElement("div");
        star.classList.add("star");

        const randomX = Math.random() * window.innerWidth;
        const randomY = Math.random() * window.innerHeight;

        const randomDuration = Math.random() * 5 + 3; // Th·ªùi gian nh·∫•p nh√°y
        const randomDelay = Math.random() * 5; // ƒê·ªô tr·ªÖ nh·∫•p nh√°y

        star.style.top = `${randomY}px`;
        star.style.left = `${randomX}px`;
        star.style.animationDuration = `${randomDuration}s`;
        star.style.animationDelay = `${randomDelay}s`;

        body.appendChild(star);
        stars.push(star); // L∆∞u ng√¥i sao ƒë·ªÉ di chuy·ªÉn sau
      }

      // H√†m ƒë·ªÉ di chuy·ªÉn c√°c ng√¥i sao ƒë·∫øn v·ªã tr√≠ m·ªõi sau m·ªói 5 gi√¢y
      function moveStars() {
        stars.forEach((star) => {
          const newX = Math.random() * window.innerWidth;
          const newY = Math.random() * window.innerHeight;

          star.style.top = `${newY}px`;
          star.style.left = `${newX}px`;
        });
      }

      // T·ª± ƒë·ªông di chuy·ªÉn sao sau m·ªói 5 gi√¢y
      setInterval(moveStars, 5000);

      // L·∫•y c√°c ph·∫ßn t·ª≠ form
      const loginForm = document.getElementById("login-form");
      const registerForm = document.getElementById("register-form");
      const forgotForm = document.getElementById("forgot-form");

      // Chuy·ªÉn ƒë·ªïi form
      document
        .getElementById("show-register")
        .addEventListener("click", (e) => {
          e.preventDefault();
          loginForm.classList.add("hidden");
          registerForm.classList.remove("hidden");
          forgotForm.classList.add("hidden");
        });

      document.getElementById("show-forgot").addEventListener("click", (e) => {
        e.preventDefault();
        loginForm.classList.add("hidden");
        registerForm.classList.add("hidden");
        forgotForm.classList.remove("hidden");
      });

      document
        .getElementById("show-login-from-register")
        .addEventListener("click", (e) => {
          e.preventDefault();
          loginForm.classList.remove("hidden");
          registerForm.classList.add("hidden");
          forgotForm.classList.add("hidden");
        });

      document
        .getElementById("show-login-from-forgot")
        .addEventListener("click", (e) => {
          e.preventDefault();
          loginForm.classList.remove("hidden");
          registerForm.classList.add("hidden");
          forgotForm.classList.add("hidden");
        });

      // X·ª≠ l√Ω ƒëƒÉng nh·∫≠p
      document
        .getElementById("login-btn")
        .addEventListener("click", async (e) => {
          e.preventDefault();
          const username = document
            .getElementById("login-username")
            .value.trim();
          const password = document
            .getElementById("login-password")
            .value.trim();

          if (!username || !password) {
            alert("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin");
            return;
          }

          try {
            const response = await fetch("/api/login", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, password }),
            });

            const data = await response.json();

            if (response.ok) {
              alert("üéâ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!");
              // Chuy·ªÉn h∆∞·ªõng sang trang dashboard.html sau khi ƒëƒÉng nh·∫≠p th√†nh c√¥ng
              window.location.href = "/dashboard.html";
            } else {
              alert("‚ùå L·ªói: " + (data.message || "ƒêƒÉng nh·∫≠p th·∫•t b·∫°i"));
            }
          } catch (error) {
            console.error("L·ªói khi ƒëƒÉng nh·∫≠p:", error);
            alert("üö® L·ªói k·∫øt n·ªëi m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.");
          }
        });

      // X·ª≠ l√Ω ƒëƒÉng k√Ω
      document
        .getElementById("register-btn")
        .addEventListener("click", async (e) => {
          e.preventDefault();

          const username = document.getElementById("reg-username").value.trim();
          const phone = document.getElementById("reg-phone").value.trim();
          const password = document.getElementById("reg-password").value.trim();
          const confirmPassword = document
            .getElementById("reg-confirm")
            .value.trim();

          if (!username || !phone || !password || !confirmPassword) {
            alert("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin");
            return;
          }

          if (password !== confirmPassword) {
            alert("‚ùå M·∫≠t kh·∫©u kh√¥ng kh·ªõp");
            return;
          }

          try {
            const response = await fetch("/api/register", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, phone, password }),
            });

            const data = await response.json();

            if (response.ok) {
              alert("üéâ ƒêƒÉng k√Ω th√†nh c√¥ng! Vui l√≤ng ƒëƒÉng nh·∫≠p.");
              document.getElementById("login-form").classList.remove("hidden");
              document.getElementById("register-form").classList.add("hidden");
            } else {
              alert("‚ùå L·ªói: " + (data.message || "ƒêƒÉng k√Ω th·∫•t b·∫°i"));
            }
          } catch (error) {
            console.error("L·ªói khi ƒëƒÉng k√Ω:", error);
            alert("üö® L·ªói k·∫øt n·ªëi m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.");
          }
        });

      // X·ª≠ l√Ω qu√™n m·∫≠t kh·∫©u
      document
        .getElementById("forgot-btn")
        .addEventListener("click", async (e) => {
          e.preventDefault();
          const username = document
            .getElementById("forgot-username")
            .value.trim();
          const phone = document.getElementById("forgot-phone").value.trim();

          if (!username || !phone) {
            alert("‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n ng∆∞·ªùi d√πng v√† s·ªë ƒëi·ªán tho·∫°i");
            return;
          }

          try {
            const response = await fetch("/api/forgot-password", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, phone }),
            });

            const data = await response.json();

            if (response.ok) {
              alert(
                "‚úÖ Y√™u c·∫ßu ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c g·ª≠i. Vui l√≤ng ki·ªÉm tra ƒëi·ªán tho·∫°i."
              );
            } else {
              alert(
                "‚ùå L·ªói: " +
                  (data.message || "Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng")
              );
            }
          } catch (error) {
            console.error("L·ªói khi g·ª≠i y√™u c·∫ßu qu√™n m·∫≠t kh·∫©u:", error);
            alert("üö® L·ªói k·∫øt n·ªëi m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.");
          }
        });
    </script>
  </body>
</html>
